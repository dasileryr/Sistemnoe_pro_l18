# Лабораторные работы по системному программированию

## Проект 1: WordScannerApp - Поиск запрещенных слов в файлах

### Описание
Приложение для поиска запрещенных слов во всех файлах на доступных накопителях информации (жесткие диски, флешки).

### Функциональность
- Ввод или загрузка из файла набора запрещенных слов
- Поиск по всем доступным дискам
- Копирование найденных файлов в указанную папку
- Создание модифицированных файлов с заменой запрещенных слов на `*******`
- Генерация отчета с информацией о найденных файлах и топ-10 самых популярных запрещенных слов
- Прогресс-бары для отображения прогресса работы
- Возможность приостановить, возобновить или остановить сканирование
- Многопоточность и синхронизация
- Запуск только в одной копии
- Поддержка запуска из командной строки без GUI

### Использование

#### Графический интерфейс
1. Запустите `WordScannerApp.exe`
2. Введите запрещенные слова или загрузите из файла
3. Укажите выходную директорию
4. Выберите расширения файлов для поиска
5. Нажмите "Старт"

#### Командная строка
```bash
WordScannerApp.exe --no-gui --words "words.txt" --output "C:\Output" --extensions ".txt,.doc,.pdf"
```

Параметры:
- `--no-gui` - запуск без графического интерфейса
- `--words <файл>` - путь к файлу с запрещенными словами (по одному слову на строку)
- `--output <директория>` - выходная директория для сохранения результатов
- `--extensions <расширения>` - расширения файлов через запятую (опционально, по умолчанию .txt)

### Структура проекта
```
WordScannerApp/
├── Models/
│   └── FileScanResult.cs          # Модель результата сканирования файла
├── Services/
│   ├── FileScannerService.cs      # Сервис сканирования файлов
│   └── ReportService.cs           # Сервис генерации отчетов
├── MainWindow.xaml                # Главное окно приложения
├── MainWindow.xaml.cs             # Логика главного окна
├── App.xaml                       # Определение приложения
├── App.xaml.cs                    # Инициализация приложения
└── Program.cs                     # Точка входа с поддержкой командной строки
```

---

## Проект 2: UserMonitorApp - Мониторинг работы пользователя

### Описание
Приложение для слежения за работой пользователя на компьютере с тремя режимами работы: настройка, слежение и отчеты.

### Функциональность

#### Режим настройки
- Включение/выключение статистики
- Включение/выключение модерирования
- Настройка пути для сохранения отчетов
- Настройка списка запрещенных слов
- Настройка списка запрещенных программ

#### Режим слежения
- Мониторинг нажатий клавиш (если включена статистика)
- Мониторинг запущенных процессов (если включена статистика)
- Модерирование: обнаружение запрещенных слов и создание отчетов
- Модерирование: блокировка запрещенных программ
- Отображение статистики в реальном времени
- Лог событий

#### Режим отчетов
- Просмотр всех созданных отчетов
- Открытие отчетов для просмотра
- Открытие папки с отчетами

### Использование
1. Запустите `UserMonitorApp.exe`
2. Перейдите на вкладку "Настройки" и настройте параметры
3. Сохраните настройки
4. Перейдите на вкладку "Слежение" и нажмите "Запустить мониторинг"
5. Для просмотра результатов перейдите на вкладку "Отчеты"

### Типы отчетов
- **KeyLog_YYYYMMDD.txt** - лог всех нажатий клавиш
- **ProcessLog_YYYYMMDD.txt** - лог всех запущенных процессов
- **ModerationReport_YYYYMMDD_HHmmss.txt** - отчеты о модерации (запрещенные слова/программы)

### Структура проекта
```
UserMonitorApp/
├── Models/
│   ├── MonitorSettings.cs         # Настройки мониторинга
│   ├── KeyLogEntry.cs            # Запись о нажатии клавиши
│   └── ProcessLogEntry.cs        # Запись о процессе
├── Services/
│   ├── KeyboardMonitorService.cs # Сервис мониторинга клавиатуры
│   └── ProcessMonitorService.cs  # Сервис мониторинга процессов
├── MainWindow.xaml               # Главное окно с вкладками
├── MainWindow.xaml.cs            # Логика главного окна
├── ReportViewWindow.xaml         # Окно просмотра отчета
├── ReportViewWindow.xaml.cs      # Логика окна просмотра
├── App.xaml                      # Определение приложения
└── App.xaml.cs                   # Инициализация приложения
```

### Технические детали
- Использование Windows API для перехвата клавиатуры (LowLevelKeyboardHook)
- Многопоточность для асинхронной записи логов
- Синхронизация доступа к общим ресурсам
- Запуск только в одной копии (Mutex)

---

## Требования
- .NET 8.0 или выше
- Windows (для Windows API hooks)
- Visual Studio 2022 или выше (для сборки)

## Сборка
```bash
# WordScannerApp
cd WordScannerApp
dotnet build

# UserMonitorApp
cd UserMonitorApp
dotnet build
```

## Примечания
- Для работы UserMonitorApp требуются права администратора (для перехвата клавиатуры и мониторинга процессов)
- WordScannerApp может работать без прав администратора, но может не иметь доступа к некоторым системным папкам
- Оба приложения используют механизм Mutex для предотвращения запуска нескольких копий

